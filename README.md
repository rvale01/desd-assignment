# Assignment app

This is the repo which contains the code for the desd assignment.
In the repo there id:
- sql dump, which is loaded by the dockerfile to be used as a starting point (this contains hardcoded films and showings, and some accounts, however there is the possibility to register a new account too)

- all the scripts needed to run docker (Dockerfile, requirements.txt, wait-for, django-app-entrypoint, docker-compose.yml). 
  The wait-for file was given to us during the tutorials/lectures.
  The Dockerfile, django-app-entrypoint, docker-compose.yml have been written by me taking as a starting points the ones given during the lectures/tutorials
  The requirements.txt was generated using pipenv

- The two django applications: app and customer.

# App
For the assignment, I have choosen the 'customer' user type. The list of requirements is in the appendix of the report.
The docker app contains two applications: the main app and the customer app.
The main app contains all the logic of the login/registration and views to handle them. Also, there is a base.css which is used by the customer application as well.

The templates in the main app are for the 404 page, the homepage, the login and the registration.
In the settings.py file, there are all the configurations needed to run the app smoothly. This file (like most of the other files) is generated by Django when creating the project, but after it was edited and updated with the configs needed for the project. 
Some of the edits done are:
- added the customer app to the list of INSTALLED_APPS
- added TEMPLATES, which contains the directory where to find all the templates
- updated DATABASES with the details to initialised in the Docker yml file.
- added all the configs to use the static files
- added the LOGIN_REDIRECT_URL and LOGOUT_REDIRECT_URL

In the urls.py file, a few urls were added, one for the accounts, which uses the auth functions provided by Django, the registration/customer which uses a view created by me, the homepage, and the customer url which includes all the urls of the customer application.


# Customer
The customer app contains templates, static files, views, urls, forms and models. The models were used to create the database.
The views are grouped in three different folders: booking, payment, and tickets. All the views require the user to be logged in
The templates used all extend the base.html template in the same folder.
The static files are specific for each template which uses them. Also, each template extends the base.css file which can be found in the app/static folder.
The urls grouped based on each view.


# Flow
<h3>Homepage</h3>
The first page shown is the home page. 
  - If the user is not logged, the Login and Registration buttons are show.
  - If the user is logged, the Book Now, Logout, and Delete account buttons are shown.

<h4>Login</h4>
The user can login to their account with their username and password.

<h4>Registration</h4>
The user can register using a password and an username. If there are errors, the same page is shown with the errors in red.
If the user is register successfully, the login page is shown, so the user can use the new username and password to login.
At the moment, there is only one type of user: the customer.

<h4>Logout</h4>
If the customer is logged in, they can press the logout button. If they do, the user is logged out and the homepage is shown.

<h4>Delete account</h4>
The user can delete their account. If they do and it is successful, a page saying the user was deleted is shown.

<h4>Booking process</h4>
The first page shown is where the user can select the date. The select is pre-filled with all the dates available which have at least 1 seating space
available. After the date is selected, the time select is shown, it has a pre-filled select with all the times available of the selected date.

When that is selected, the available shows are shown. For each show, the date, the time and, the title are shown.
The user then selects one of the available shows. This opens a new page with all the details of the show (date, time, plot and age rating).

The user then selects the Book now button and then a page with all the available tickets is shown (students, adults, children). 
The user then needs to input all the tickets they want. Once done that, they need to press the button to continue.

Then a page with a short review of the selected tickets is shown, along with the total.
Once the user is happy with that, they can press the pay button and a custom Stripe url is generated, which will show a review of the tickets and they will need to pay.

FOR THE REVIEWER: in order to test the Stripe payment, you can use this card: 4242 4242 4242 4242, with any ccv, and any date.

Once the user pays and the payment is successful, the success page is shown. In this view, the new booking is added to the booking table and the seating_availability of the showing is updated.



